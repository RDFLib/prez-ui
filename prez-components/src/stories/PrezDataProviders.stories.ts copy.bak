import type { Meta, StoryObj } from "@storybook/vue3";
import { vueRouter } from "storybook-vue3-router";
import { node, literal } from "prez-lib"
import PrezUIDataList from "../components/PrezUIDataList.vue";
import PrezUIDataItem from "../components/PrezUIDataItem.vue";
import PrezDataProvider from "../components/PrezDataProvider.vue";
import PrezUIObjectTable from '../components/PrezUIObjectTable.vue';
import PrezUIBlankNode from "../components/PrezUIBlankNode.vue";

const meta = {
    title: "PrezDataProviders",
    component: { PrezDataProvider, PrezUIDataList, PrezUIDataItem },
    tags: ["autodocs"],
    argTypes: {
        url: { description: "The URL endpoint" },
        objectId: { description: "Object ID for object lookups"}
    }
};// satisfies Meta<typeof PrezDataListProvider>;

export default meta;
type Story = StoryObj<typeof meta>;

const TemplateList = (args, { argTypes }) => ({
    components: { PrezDataProvider, PrezUIDataList },
    props: Object.keys(argTypes),
    template: `
      <PrezDataProvider type="list" :url="args.url">
        <template v-slot="{ data, properties }">
            <PrezUIDataList :data="data" :properties="properties" />
        </template>
      </PrezDataProvider>
    `,
    setup() {
        return { args };
    }
});

export const CatalogList: Story = TemplateList.bind({});
CatalogList.args = {
    //url: 'https://prezv4-with-fuseki.sgraljii8d3km.ap-southeast-2.cs.amazonlightsail.com/catalogs'
    url: 'https://api.koenigsnet.alpha.kurrawong.ai/sparql?query=PREFIX+rdfs:+%3Chttp:%2F%2Fwww.w3.org%2F2000%2F01%2Frdf-schema%23%3E%0APREFIX+geo:+%3Chttp:%2F%2Fwww.opengis.net%2Font%2Fgeosparql%23%3E%0APREFIX+dcterms:+%3Chttp:%2F%2Fpurl.org%2Fdc%2Fterms%2F%3E%0A%0ACONSTRUCT+%7B%0A++%3Freport+dcterms:hasPart+%3Fpdf_uri+.%0A++%3Fborehole+dcterms:isReferencedBy+%3Freport+%3B%0A++++geo:hasGeometry+%3Fborehole_geom+%3B%0A++++rdfs:label+%3Fbh_label+.%0A++%3Fborehole_geom+geo:asWKT+%3Fbh_wkt+.%0A%7D%0AWHERE+%7B%0A++BIND(%22f3489d13-bf32-468a-a1b2-75c522a08ebd-7.pdf%22+as+%3FpdfUrl)%0A++BIND(URI(CONCAT(%22https:%2F%2Fkoenigsnet%2Fdoc%2F%22,+%3FpdfUrl))+AS+%3Fpdf_uri)%0A++%3Freport+dcterms:hasPart+%3Fpdf_uri+.%0A++%3Fborehole+dcterms:isReferencedBy+%3Freport+%3B%0A++++++++++++geo:hasGeometry+%3Fborehole_geom+%3B%0A++++++++++++rdfs:label+%3Fbh_label+.%0A++%3Fborehole_geom+geo:asWKT+%3Fbh_wkt+.%0A%7D'
};

export const VocabList: Story = TemplateList.bind({});
VocabList.args = {
    url: 'https://prezv4-with-fuseki.sgraljii8d3km.ap-southeast-2.cs.amazonlightsail.com/catalogs/bblck-ctlg:bblocks/collections'
};


const TemplateItem = (args, { argTypes }) => ({
    components: { PrezDataProvider, PrezUIDataItem, PrezUIDataList },
    props: Object.keys(argTypes),
    template: `
      <PrezDataProvider type="object" :url="args.url" :objectId="args.objectId">
        <template v-slot="{ data, properties }">
            <PrezUIDataItem :data="data" :properties="properties" />
        </template>
      </PrezDataProvider>
    `,
    setup() {
        return { args };
    }
});


export const CatalogItem: Story = TemplateItem.bind({});
CatalogItem.args = {
    url: 'https://prezv4-with-fuseki.sgraljii8d3km.ap-southeast-2.cs.amazonlightsail.com/catalogs/bblck-ctlg:bblocks',
    objectId: 'bblck-ctlg:bblocks'
};

const TemplateItemTable = (args, { argTypes }) => ({
    components: { PrezDataProvider, PrezUIObjectTable, PrezUIBlankNode },
    props: Object.keys(argTypes),
    template: `
      <PrezDataProvider type="object" :url="args.url" :objectId="args.objectId">
        <template v-slot="{ data, properties }">
            <PrezUIBlankNode :data="data" :loading="!data" :properties="properties" />
        </template>
      </PrezDataProvider>
    `,
    setup() {
        return { args };
    }
});

export const CatalogItem2: Story = TemplateItemTable.bind({});
CatalogItem2.args = {
    url: 'https://prezv4-with-fuseki.sgraljii8d3km.ap-southeast-2.cs.amazonlightsail.com/catalogs/bblck-ctlg:bblocks',
    objectId: 'bblck-ctlg:bblocks'
};

// Default.decorators = [
//     vueRouter()
// ];

